<html>
  <head>
<title>Book Map</title>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-164257655-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-164257655-1');
</script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="../bootstrap.min.js"></script>
<link href="../bootstrap.min.css" rel="stylesheet">
<link href="../bootstrap-theme.min.css" rel="stylesheet">

<script type="text/javascript">

  var worldBooks = new Array();
  worldBooks.push(['Country', 'Year', {role: 'tooltip', p:{html:true}}]);

  var rowData = [];

  function readData(parent) {
      httpGetAsync('https://docs.google.com/spreadsheets/d/e/2PACX-1vQcfkiJl4CazSTahNAb7A1hI01klAvQUpCfVC_TrDO9aVYe1BErUaYHXMMnoa-ErjnJUjWU88gU6cuA/pub?gid=1722454984&single=true&output=csv', function(result){
          let str = result;
          let lines = str.split('\r\n');
          for (var i=0; i<lines.length; i++){
            let line = lines[i].split(',');
            rowData.push(line);
          }
      });

      console.log(rowData);

      for(var r=0; r<rowData.length; r++) {
        var tmp_row = [rowData[r][2], parseInt(rowData[r][3]), rowData[r][3]+'<br><br>'+rowData[r][0]+'<br><i>'+rowData[r][1]+'</i>'];
        console.log(tmp_row);
        worldBooks.push(tmp_row);
      }

      console.log(worldBooks);
  }
      function drawRegionsMap() {
        readData($("#data"));

        var data = google.visualization.arrayToDataTable(worldBooks);

        var options = {
          colorAxis: {colors: ['#3366ff','#3366ff']},
          legend: 'none',
          tooltip: {
            isHtml: true
          }
        };

        var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

        chart.draw(data, options);
      }

function httpGetAsync(theUrl, callback) {
  let xmlHttpReq = new XMLHttpRequest();
  xmlHttpReq.onreadystatechange = function () {
    if (xmlHttpReq.readyState == 4 && xmlHttpReq.status == 200)
      callback(xmlHttpReq.responseText);
  }
  xmlHttpReq.open("GET", theUrl, true); // true for asynchronous
  xmlHttpReq.send(null);
}

  $(document).ready(function(){
      google.charts.load('current', {
        'packages':['geochart'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
      });
      google.charts.setOnLoadCallback(drawRegionsMap);
  });

    </script>

<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">

  </head>
  <body style="width: 90%;margin: auto;">
  <br>
<a href="../">
  <span class="glyphicon glyphicon-home"></span>
</a>

<center><h3>Book Map</h3></center>
    <div id="regions_div" style="width: 100%;"></div>
  </body>
</html>
